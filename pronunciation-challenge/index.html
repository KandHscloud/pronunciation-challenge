<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç°¡æ˜“ç™¼éŸ³æŒ‘æˆ°</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            width: 100%;
            background-color: white;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border-radius: 12px;
            padding: 30px;
            margin-top: 40px;
        }
        
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
        }
        
        .instructions {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
        }
        
        .instructions h2 {
            margin-bottom: 15px;
            color: #2c3e50;
        }
        
        .instructions ol {
            padding-left: 20px;
        }
        
        .instructions li {
            margin-bottom: 10px;
            line-height: 1.6;
        }
        
        .difficulty-selector {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 30px;
            gap: 15px;
        }
        
        select {
            padding: 10px 15px;
            border-radius: 6px;
            border: 1px solid #ddd;
            background-color: white;
            font-size: 16px;
        }
        
        .practice-area {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .challenge-text {
            font-size: 28px;
            font-weight: bold;
            text-align: center;
            margin: 30px 0;
            min-height: 60px;
            color: #2c3e50;
        }
        
        .syllables {
            font-size: 18px;
            color: #7f8c8d;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .translation {
            font-size: 16px;
            color: #2980b9;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .result-container {
            width: 100%;
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
        }
        
        .recognition-result {
            font-size: 18px;
            color: #555;
            text-align: center;
            margin-bottom: 15px;
            min-height: 30px;
        }
        
        .feedback {
            font-size: 20px;
            text-align: center;
            font-weight: bold;
            margin-bottom: 20px;
            min-height: 30px;
        }
        
        .score {
            text-align: center;
            font-size: 18px;
            color: #2c3e50;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }
        
        button {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .btn-start {
            background-color: #27ae60;
            color: white;
        }
        
        .btn-speak {
            background-color: #3498db;
            color: white;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-speak svg {
            width: 20px;
            height: 20px;
        }
        
        .btn-next {
            background-color: #e67e22;
            color: white;
        }
        
        .btn-end {
            background-color: #e74c3c;
            color: white;
        }
        
        button:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }
        
        .correct {
            color: #27ae60;
        }
        
        .incorrect {
            color: #e74c3c;
        }
        
        .hidden {
            display: none;
        }
        
        .footer {
            margin-top: 40px;
            text-align: center;
            color: #7f8c8d;
            font-size: 14px;
        }
        
        /* éŸ¿æ‡‰å¼è¨­è¨ˆ */
        @media (max-width: 600px) {
            .container {
                padding: 20px;
            }
            
            .challenge-text {
                font-size: 24px;
            }
            
            .controls {
                flex-direction: column;
            }
            
            button {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ç°¡æ˜“ç™¼éŸ³æŒ‘æˆ°</h1>
        
        <div class="instructions">
            <h2>ä½¿ç”¨èªªæ˜</h2>
            <ol>
                <li>é¸æ“‡é›£åº¦ç´šåˆ¥ï¼ˆå–®è©ã€çŸ­èªæˆ–å¥å­ï¼‰</li>
                <li>é»æ“Šã€Œé–‹å§‹ç·´ç¿’ã€æŒ‰éˆ•</li>
                <li>é»æ“Šã€Œä¸‹ä¸€å€‹ã€ç²å–æ–°çš„å–®è©æˆ–çŸ­èª</li>
                <li>æŒ‰ä¸‹ã€Œèªªè©±ã€æŒ‰éˆ•ä¸¦æ¸…æ™°åœ°ç™¼éŸ³é¡¯ç¤ºçš„æ–‡å­—</li>
                <li>ç³»çµ±æœƒæª¢æŸ¥æ‚¨çš„ç™¼éŸ³æ˜¯å¦èˆ‡é¡¯ç¤ºçš„æ–‡å­—åŒ¹é…</li>
            </ol>
        </div>
        
        <div class="difficulty-selector">
            <label for="difficulty">é›£åº¦ï¼š</label>
            <select id="difficulty">
                <option value="easy">ç°¡å–® (å–®è©)</option>
                <option value="medium">ä¸­ç­‰ (çŸ­èª)</option>
                <option value="hard">å›°é›£ (å¥å­)</option>
            </select>
        </div>
        
        <div class="practice-area">
            <div class="challenge-text" id="challenge-text">é»æ“Šã€Œé–‹å§‹ç·´ç¿’ã€é–‹å§‹</div>
            <div class="syllables" id="syllables"></div>
            <div class="translation" id="translation"></div>
            
            <div class="result-container">
                <div class="recognition-result" id="recognition-result">æ‚¨çš„èªéŸ³å°‡é¡¯ç¤ºåœ¨é€™è£¡</div>
                <div class="feedback" id="feedback"></div>
                <div class="score" id="score">æ­£ç¢º: 0 | éŒ¯èª¤: 0</div>
            </div>
            
            <div class="controls">
                <button id="start-btn" class="btn-start">é–‹å§‹ç·´ç¿’</button>
                <button id="speak-btn" class="btn-speak hidden">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"></path>
                        <path d="M19 10v2a7 7 0 0 1-14 0v-2"></path>
                        <line x1="12" y1="19" x2="12" y2="22"></line>
                    </svg>
                    èªªè©±
                </button>
                <button id="next-btn" class="btn-next hidden">ä¸‹ä¸€å€‹</button>
                <button id="end-btn" class="btn-end hidden">çµæŸç·´ç¿’</button>
            </div>
        </div>
    </div>
    
    <div class="footer">
        å‰µå»ºæ–¼ 2025 å¹´ 3 æœˆ
    </div>
    
    <script>
        // å–®è©åº«
        const wordBanks = {
            easy: [
                { text: "apple", syllables: "ap-ple", translation: "è˜‹æœ" },
                { text: "banana", syllables: "ba-na-na", translation: "é¦™è•‰" },
                { text: "computer", syllables: "com-pu-ter", translation: "é›»è…¦" },
                { text: "language", syllables: "lan-guage", translation: "èªè¨€" },
                { text: "important", syllables: "im-por-tant", translation: "é‡è¦çš„" },
                { text: "university", syllables: "u-ni-ver-si-ty", translation: "å¤§å­¸" },
                { text: "beautiful", syllables: "beau-ti-ful", translation: "ç¾éº—çš„" },
                { text: "interesting", syllables: "in-te-res-ting", translation: "æœ‰è¶£çš„" },
                { text: "technology", syllables: "tech-no-lo-gy", translation: "ç§‘æŠ€" },
                { text: "pronunciation", syllables: "pro-nun-ci-a-tion", translation: "ç™¼éŸ³" }
            ],
            medium: [
                { text: "good morning", syllables: "good mor-ning", translation: "æ—©å®‰" },
                { text: "thank you very much", syllables: "thank you ve-ry much", translation: "éå¸¸æ„Ÿè¬" },
                { text: "nice to meet you", syllables: "nice to meet you", translation: "å¾ˆé«˜èˆˆèªè­˜ä½ " },
                { text: "how are you today", syllables: "how are you to-day", translation: "ä½ ä»Šå¤©å¥½å—" },
                { text: "see you tomorrow", syllables: "see you to-mor-row", translation: "æ˜å¤©è¦‹" },
                { text: "where is the library", syllables: "where is the li-brar-y", translation: "åœ–æ›¸é¤¨åœ¨å“ªè£¡" },
                { text: "what time is it", syllables: "what time is it", translation: "ç¾åœ¨å¹¾é»äº†" },
                { text: "happy birthday to you", syllables: "hap-py birth-day to you", translation: "ç¥ä½ ç”Ÿæ—¥å¿«æ¨‚" },
                { text: "I like this song", syllables: "I like this song", translation: "æˆ‘å–œæ­¡é€™é¦–æ­Œ" },
                { text: "speak more slowly please", syllables: "speak more slow-ly please", translation: "è«‹èªªæ…¢ä¸€é»" }
            ],
            hard: [
                { text: "I would like to improve my English pronunciation", syllables: "I would like to im-prove my Eng-lish pro-nun-ci-a-tion", translation: "æˆ‘æƒ³æ”¹é€²æˆ‘çš„è‹±èªç™¼éŸ³" },
                { text: "Can you recommend a good restaurant near here", syllables: "Can you re-com-mend a good res-tau-rant near here", translation: "ä½ èƒ½æ¨è–¦é™„è¿‘çš„å¥½é¤å»³å—" },
                { text: "The weather is beautiful today so I want to go for a walk", syllables: "The wea-ther is beau-ti-ful to-day so I want to go for a walk", translation: "ä»Šå¤©å¤©æ°£å¾ˆå¥½ï¼Œæ‰€ä»¥æˆ‘æƒ³å»æ•£æ­¥" },
                { text: "Learning a new language takes a lot of practice and patience", syllables: "Learn-ing a new lan-guage takes a lot of prac-tice and pa-tience", translation: "å­¸ç¿’æ–°èªè¨€éœ€è¦å¤§é‡çš„ç·´ç¿’å’Œè€å¿ƒ" },
                { text: "Thank you for helping me with my pronunciation practice", syllables: "Thank you for help-ing me with my pro-nun-ci-a-tion prac-tice", translation: "è¬è¬ä½ å¹«æˆ‘ç·´ç¿’ç™¼éŸ³" },
                { text: "I need to buy some groceries at the supermarket this afternoon", syllables: "I need to buy some gro-ce-ries at the su-per-mar-ket this af-ter-noon", translation: "æˆ‘ä»Šå¤©ä¸‹åˆéœ€è¦å»è¶…å¸‚è²·äº›é›œè²¨" },
                { text: "Could you please speak more slowly I didn't understand", syllables: "Could you please speak more slow-ly I did-n't un-der-stand", translation: "è«‹ä½ èªªæ…¢ä¸€äº›ï¼Œæˆ‘æ²’æœ‰è½æ‡‚" },
                { text: "This is my first time visiting this beautiful country", syllables: "This is my first time vi-si-ting this beau-ti-ful coun-try", translation: "é€™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡è¨ªå•é€™å€‹ç¾éº—çš„åœ‹å®¶" },
                { text: "I'm studying English because I want to travel around the world", syllables: "I'm stu-dy-ing Eng-lish be-cause I want to tra-vel a-round the world", translation: "æˆ‘å­¸ç¿’è‹±èªæ˜¯å› ç‚ºæˆ‘æƒ³ç’°éŠä¸–ç•Œ" },
                { text: "The pronunciation challenge app helps me practice my speaking skills", syllables: "The pro-nun-ci-a-tion chal-lenge app helps me prac-tice my speak-ing skills", translation: "ç™¼éŸ³æŒ‘æˆ°æ‡‰ç”¨å¹«åŠ©æˆ‘ç·´ç¿’å£èªæŠ€èƒ½" }
            ]
        };
        
        // åˆå§‹åŒ–è®Šæ•¸
        let currentBank = "easy";
        let currentIndex = -1;
        let correctCount = 0;
        let wrongCount = 0;
        let recognition;
        let isRecognizing = false;
        
        // ç²å–DOMå…ƒç´ 
        const difficultySelect = document.getElementById("difficulty");
        const challengeText = document.getElementById("challenge-text");
        const syllablesDiv = document.getElementById("syllables");
        const translationDiv = document.getElementById("translation");
        const recognitionResult = document.getElementById("recognition-result");
        const feedback = document.getElementById("feedback");
        const score = document.getElementById("score");
        const startBtn = document.getElementById("start-btn");
        const speakBtn = document.getElementById("speak-btn");
        const nextBtn = document.getElementById("next-btn");
        const endBtn = document.getElementById("end-btn");
        
        // åˆå§‹åŒ–èªéŸ³è­˜åˆ¥
        function initSpeechRecognition() {
    try {
        window.SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        recognition = new SpeechRecognition();
        
        // è¨­ç½®èªéŸ³è­˜åˆ¥é¸é …
        recognition.lang = 'en-US'; // è¨­ç½®ç‚ºè‹±èª
        recognition.continuous = false; // ä¸é€£çºŒè­˜åˆ¥
        recognition.interimResults = false; // ä¸è¿”å›è‡¨æ™‚çµæœ
        
        // èªéŸ³è­˜åˆ¥çµæœäº‹ä»¶è™•ç†
        recognition.onresult = function(event) {
            const result = event.results[0][0].transcript.trim().toLowerCase();
            recognitionResult.textContent = result;
            
            // æª¢æŸ¥ç™¼éŸ³æ˜¯å¦æ­£ç¢º (å¿½ç•¥å¤§å°å¯«å’Œæ¨™é»ç¬¦è™Ÿ)
            const currentText = wordBanks[currentBank][currentIndex].text.toLowerCase();
            const normalizedResult = result.replace(/[.,\/#!$%\^&\*;:{}=\-_`~()]/g, "");
            
            if (normalizedResult === currentText) {
                feedback.textContent = "æ­£ç¢º! ğŸ‘";
                feedback.className = "feedback correct";
                correctCount++;
            } else {
                feedback.textContent = "å†è©¦ä¸€æ¬¡! ğŸ‘";
                feedback.className = "feedback incorrect";
                wrongCount++;
            }
            
            // æ›´æ–°åˆ†æ•¸
            updateScore();
        };
        
        // èªéŸ³è­˜åˆ¥çµæŸäº‹ä»¶è™•ç†
        recognition.onend = function() {
            speakBtn.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"></path>
                    <path d="M19 10v2a7 7 0 0 1-14 0v-2"></path>
                    <line x1="12" y1="19" x2="12" y2="22"></line>
                </svg>
                èªªè©±
            `;
            isRecognizing = false;
        };
        
        // èªéŸ³è­˜åˆ¥éŒ¯èª¤äº‹ä»¶è™•ç†
        recognition.onerror = function(event) {
            console.error("èªéŸ³è­˜åˆ¥éŒ¯èª¤:", event.error);
            recognitionResult.textContent = "éŒ¯èª¤: " + event.error;
            isRecognizing = false;
        };
        
    } catch (e) {
        console.error("ç€è¦½å™¨ä¸æ”¯æŒèªéŸ³è­˜åˆ¥ API:", e);
        alert("æ‚¨çš„ç€è¦½å™¨ä¸æ”¯æŒèªéŸ³è­˜åˆ¥åŠŸèƒ½ï¼Œè«‹ä½¿ç”¨ Chromeã€Edge æˆ– Safari ç€è¦½å™¨ã€‚");
    }
}

// æ›´æ–°åˆ†æ•¸é¡¯ç¤º
function updateScore() {
    score.textContent = `æ­£ç¢º: ${correctCount} | éŒ¯èª¤: ${wrongCount}`;
}

// ç²å–ä¸‹ä¸€å€‹æŒ‘æˆ°
function getNextChallenge() {
    // æ¸…é™¤ä¹‹å‰çš„çµæœ
    recognitionResult.textContent = "æ‚¨çš„èªéŸ³å°‡é¡¯ç¤ºåœ¨é€™è£¡";
    feedback.textContent = "";
    
    // éš¨æ©Ÿé¸æ“‡ä¸€å€‹ç´¢å¼•
    const bankLength = wordBanks[currentBank].length;
    let newIndex;
    do {
        newIndex = Math.floor(Math.random() * bankLength);
    } while (newIndex === currentIndex && bankLength > 1);
    
    currentIndex = newIndex;
    
    // é¡¯ç¤ºæ–°çš„æŒ‘æˆ°
    const challenge = wordBanks[currentBank][currentIndex];
    challengeText.textContent = challenge.text;
    syllablesDiv.textContent = challenge.syllables;
    translationDiv.textContent = challenge.translation;
}

// é–‹å§‹ç·´ç¿’
function startPractice() {
    // åˆå§‹åŒ–èªéŸ³è­˜åˆ¥
    initSpeechRecognition();
    
    // é‡ç½®è¨ˆæ•¸
    correctCount = 0;
    wrongCount = 0;
    updateScore();
    
    // ç²å–æ‰€é¸çš„é›£åº¦
    currentBank = difficultySelect.value;
    
    // ç²å–ç¬¬ä¸€å€‹æŒ‘æˆ°
    getNextChallenge();
    
    // é¡¯ç¤ºç·´ç¿’æ§åˆ¶é …
    startBtn.classList.add("hidden");
    speakBtn.classList.remove("hidden");
    nextBtn.classList.remove("hidden");
    endBtn.classList.remove("hidden");
}

// çµæŸç·´ç¿’
function endPractice() {
    // é¡¯ç¤ºçµæœæ‘˜è¦
    alert(`ç·´ç¿’çµæŸ!\n\næ­£ç¢ºæ•¸: ${correctCount}\néŒ¯èª¤æ•¸: ${wrongCount}\næ­£ç¢ºç‡: ${correctCount + wrongCount > 0 ? Math.round((correctCount / (correctCount + wrongCount)) * 100) : 0}%`);
    
    // é‡ç½®ç•Œé¢
    challengeText.textContent = "é»æ“Šã€Œé–‹å§‹ç·´ç¿’ã€é–‹å§‹";
    syllablesDiv.textContent = "";
    translationDiv.textContent = "";
    recognitionResult.textContent = "æ‚¨çš„èªéŸ³å°‡é¡¯ç¤ºåœ¨é€™è£¡";
    feedback.textContent = "";
    
    // é¡¯ç¤ºé–‹å§‹æŒ‰éˆ•ï¼Œéš±è—å…¶ä»–æ§åˆ¶é …
    startBtn.classList.remove("hidden");
    speakBtn.classList.add("hidden");
    nextBtn.classList.add("hidden");
    endBtn.classList.add("hidden");
}

// é–‹å§‹éŒ„éŸ³
function startRecording() {
    if (!recognition) {
        alert("èªéŸ³è­˜åˆ¥æœªåˆå§‹åŒ–ï¼Œè«‹é‡æ–°é–‹å§‹ç·´ç¿’ã€‚");
        return;
    }
    
    if (isRecognizing) {
        recognition.stop();
        return;
    }
    
    // æ¸…é™¤ä¹‹å‰çš„çµæœ
    recognitionResult.textContent = "æ­£åœ¨è†è½...";
    feedback.textContent = "";
    
    // é–‹å§‹éŒ„éŸ³
    try {
        recognition.start();
        isRecognizing = true;
        
        // æ›´æ”¹æŒ‰éˆ•æ–‡æœ¬
        speakBtn.innerHTML = `
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"></path>
                <path d="M19 10v2a7 7 0 0 1-14 0v-2"></path>
                <line x1="12" y1="19" x2="12" y2="22"></line>
            </svg>
            åœæ­¢
        `;
    } catch (e) {
        console.error("å•Ÿå‹•èªéŸ³è­˜åˆ¥æ™‚å‡ºéŒ¯:", e);
        alert("å•Ÿå‹•èªéŸ³è­˜åˆ¥æ™‚å‡ºéŒ¯ï¼Œè«‹é‡è©¦ã€‚");
    }
}

// é›£åº¦è®Šæ›´è™•ç†
function handleDifficultyChange() {
    if (startBtn.classList.contains("hidden")) {
        // å¦‚æœç·´ç¿’å·²ç¶“é–‹å§‹ï¼Œå‰‡æ›´æ–°ç•¶å‰è©åº«ä¸¦ç²å–æ–°æŒ‘æˆ°
        currentBank = difficultySelect.value;
        getNextChallenge();
    }
}

// æ·»åŠ äº‹ä»¶ç›£è½å™¨
document.addEventListener("DOMContentLoaded", function() {
    startBtn.addEventListener("click", startPractice);
    speakBtn.addEventListener("click", startRecording);
    nextBtn.addEventListener("click", getNextChallenge);
    endBtn.addEventListener("click", endPractice);
    difficultySelect.addEventListener("change", handleDifficultyChange);
});
</script>
</body>
</html>
